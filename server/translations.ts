// Server-side translations for API messages
export const serverTranslations = {
  en: {
    // Authentication
    "Unauthorized": "Unauthorized",
    "Invalid email or password": "Invalid email or password",
    "Failed to login": "Failed to login",
    "Failed to logout": "Failed to logout",
    "Logged out successfully": "Logged out successfully",
    
    // User management
    "User already exists with this email": "User already exists with this email",
    "Failed to register user": "Failed to register user", 
    "User not found": "User not found",
    "Failed to fetch user": "Failed to fetch user",
    "Language is required": "Language is required",
    "Failed to update language preference": "Failed to update language preference",
    
    // Profile management
    "Professional profile not found": "Professional profile not found",
    "Failed to fetch professional profile": "Failed to fetch professional profile",
    "Failed to create professional profile": "Failed to create professional profile",
    "Failed to update professional profile": "Failed to update professional profile",
    "Company profile not found": "Company profile not found",
    "Failed to fetch company profile": "Failed to fetch company profile",
    "Failed to create company profile": "Failed to create company profile",
    "Failed to update company profile": "Failed to update company profile",
    
    // Projects
    "Project not found": "Project not found",
    "Failed to create project": "Failed to create project",
    "Failed to fetch projects": "Failed to fetch projects",
    "Failed to update project": "Failed to update project",
    "Failed to delete project": "Failed to delete project",
    
    // Posts
    "Failed to create post": "Failed to create post",
    "Failed to fetch posts": "Failed to fetch posts",
    "Failed to like post": "Failed to like post",
    "Failed to unlike post": "Failed to unlike post",
    
    // General
    "Internal Server Error": "Internal Server Error",
    "Validation failed": "Validation failed"
  },
  
  it: {
    // Authentication  
    "Unauthorized": "Non autorizzato",
    "Invalid email or password": "Email o password non validi",
    "Failed to login": "Accesso fallito",
    "Failed to logout": "Uscita fallita",
    "Logged out successfully": "Disconnesso con successo",
    
    // User management
    "User already exists with this email": "Utente già esistente con questa email",
    "Failed to register user": "Registrazione utente fallita",
    "User not found": "Utente non trovato", 
    "Failed to fetch user": "Recupero utente fallito",
    "Language is required": "La lingua è richiesta",
    "Failed to update language preference": "Aggiornamento preferenza lingua fallito",
    
    // Profile management
    "Professional profile not found": "Profilo professionale non trovato",
    "Failed to fetch professional profile": "Recupero profilo professionale fallito", 
    "Failed to create professional profile": "Creazione profilo professionale fallita",
    "Failed to update professional profile": "Aggiornamento profilo professionale fallito",
    "Company profile not found": "Profilo aziendale non trovato",
    "Failed to fetch company profile": "Recupero profilo aziendale fallito",
    "Failed to create company profile": "Creazione profilo aziendale fallita", 
    "Failed to update company profile": "Aggiornamento profilo aziendale fallito",
    
    // Projects
    "Project not found": "Progetto non trovato",
    "Failed to create project": "Creazione progetto fallita",
    "Failed to fetch projects": "Recupero progetti fallito",
    "Failed to update project": "Aggiornamento progetto fallito",
    "Failed to delete project": "Eliminazione progetto fallita",
    
    // Posts  
    "Failed to create post": "Creazione post fallita",
    "Failed to fetch posts": "Recupero post fallito",
    "Failed to like post": "Mi piace post fallito", 
    "Failed to unlike post": "Rimozione mi piace fallita",
    
    // General
    "Internal Server Error": "Errore interno del server",
    "Validation failed": "Validazione fallita"
  },

  es: {
    // Authentication  
    "Unauthorized": "No autorizado",
    "Invalid email or password": "Email o contraseña inválidos",
    "Failed to login": "Error al iniciar sesión",
    "Failed to logout": "Error al cerrar sesión", 
    "Logged out successfully": "Sesión cerrada exitosamente",
    
    // User management
    "User already exists with this email": "Ya existe un usuario con este email",
    "Failed to register user": "Error al registrar usuario",
    "User not found": "Usuario no encontrado",
    "Failed to fetch user": "Error al obtener usuario",
    "Language is required": "El idioma es requerido",
    "Failed to update language preference": "Error al actualizar preferencia de idioma",
    
    // Profile management  
    "Professional profile not found": "Perfil profesional no encontrado",
    "Failed to fetch professional profile": "Error al obtener perfil profesional",
    "Failed to create professional profile": "Error al crear perfil profesional",
    "Failed to update professional profile": "Error al actualizar perfil profesional",
    "Company profile not found": "Perfil de empresa no encontrado",
    "Failed to fetch company profile": "Error al obtener perfil de empresa",
    "Failed to create company profile": "Error al crear perfil de empresa",
    "Failed to update company profile": "Error al actualizar perfil de empresa",
    
    // Projects
    "Project not found": "Proyecto no encontrado",
    "Failed to create project": "Error al crear proyecto",
    "Failed to fetch projects": "Error al obtener proyectos", 
    "Failed to update project": "Error al actualizar proyecto",
    "Failed to delete project": "Error al eliminar proyecto",
    
    // Posts
    "Failed to create post": "Error al crear post",
    "Failed to fetch posts": "Error al obtener posts",
    "Failed to like post": "Error al dar me gusta",
    "Failed to unlike post": "Error al quitar me gusta",
    
    // General
    "Internal Server Error": "Error interno del servidor",
    "Validation failed": "Validación fallida"
  },

  fr: {
    // Authentication
    "Unauthorized": "Non autorisé",
    "Invalid email or password": "Email ou mot de passe invalide",
    "Failed to login": "Échec de connexion",
    "Failed to logout": "Échec de déconnexion",
    "Logged out successfully": "Déconnecté avec succès",
    
    // User management
    "User already exists with this email": "Un utilisateur existe déjà avec cet email",
    "Failed to register user": "Échec de l'enregistrement de l'utilisateur",
    "User not found": "Utilisateur non trouvé",
    "Failed to fetch user": "Échec de récupération de l'utilisateur", 
    "Language is required": "La langue est requise",
    "Failed to update language preference": "Échec de mise à jour de la préférence linguistique",
    
    // Profile management
    "Professional profile not found": "Profil professionnel non trouvé",
    "Failed to fetch professional profile": "Échec de récupération du profil professionnel",
    "Failed to create professional profile": "Échec de création du profil professionnel",
    "Failed to update professional profile": "Échec de mise à jour du profil professionnel",
    "Company profile not found": "Profil d'entreprise non trouvé", 
    "Failed to fetch company profile": "Échec de récupération du profil d'entreprise",
    "Failed to create company profile": "Échec de création du profil d'entreprise",
    "Failed to update company profile": "Échec de mise à jour du profil d'entreprise",
    
    // Projects  
    "Project not found": "Projet non trouvé",
    "Failed to create project": "Échec de création du projet",
    "Failed to fetch projects": "Échec de récupération des projets",
    "Failed to update project": "Échec de mise à jour du projet",
    "Failed to delete project": "Échec de suppression du projet",
    
    // Posts
    "Failed to create post": "Échec de création du post",
    "Failed to fetch posts": "Échec de récupération des posts", 
    "Failed to like post": "Échec du like",
    "Failed to unlike post": "Échec de suppression du like",
    
    // General
    "Internal Server Error": "Erreur interne du serveur",
    "Validation failed": "Validation échouée"
  }
};

export function translateMessage(message: string, language: string = 'en'): string {
  const translations = serverTranslations[language as keyof typeof serverTranslations];
  if (!translations) {
    return message; // fallback to original message
  }
  return translations[message as keyof typeof translations] || message;
}

export async function getUserLanguage(userId: string, storage: any): Promise<string> {
  try {
    const user = await storage.getUser(userId);
    return user?.language || 'en';
  } catch (error) {
    return 'en'; // fallback to English
  }
}